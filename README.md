# 서경SW아카데미 기업 연계 프로젝트(오브젠) 
## NLP를 이용한 AWS LAMBDA기반의 서버리스 웹 채팅
# https://www.yomibot.store/
![image](https://github.com/user-attachments/assets/48622d04-10e1-4e54-ac58-f44c5951b08c)

# 1. 프로젝트 설명

## 1) 프로젝트 명

> 공감식당 - 사용자와 대화하며 요리 레시피를 추천하는 챗봇 서비스를 제공하는 서비스
> 

## 2) 참여자

> [ 클라우드 & 백엔드 트랙 ] - 신호철, 정성원
> 

## 3) 프로젝트 상세 설명

> NLP를 활용하여 사용자와의 대화가 가능하고, 요청에 따라 레시피를 제공하는 챗봇을 제공하는 서비스를 개발한다. 추가적으로, 챗봇은 사용자와의 대화에서 추론된 감정에 따른 요리를 추천 할 수 있다.
 제공되는 레시피는 음식 이름, 필요 재료, 요리 과정을 포함한다.
 사용자와 챗봇간의 대화는 사용자가 서비스를 이용하는 동안 기록되며, 사용자가 서비스를 종료함과 동시에 대화내용이 저장되고, 추후 사용자가 서비스를 다시 이용하게 될때, 기록된 대화내용을 확인할 수 있다.
> 

## 4) 프로젝트 구현 방법

> **[ AI ]**
- 데이터 : 사용자와 챗봇 간의 대화, 한국어 공개 데이터셋 등을 수집하고 전처리하여 사용한다.
- 모델구현 : 챗봇은 다음의 4개의 모델을 구현하여 구축한다.
> 
> - 감정분류모델: skt에서 구축한 KoBERT 모델을 파인튜닝하여 구현하며, 사용자의 입력에서 느껴지는 감정을 분류한다. Q-emotion의 형태로 구성된 데이터셋을 이용하여 파인튜닝을 진행한다.
> - 의도분류모델: skt에서 구축한 KoBERT 모델을 파인튜닝하여 구현하며, 사용자의 입력을 ‘일반 대화’, ‘레시피 요청’ 등의 의도로 분류한다. Q-intent의 형태로 구성된 데이터셋을 이용하여 파인튜닝 한다.
> - 단어특정모델(NER): monologg님이 구축한 KoELECTRA 모델을 파인튜닝하여 구현하며, ‘레시피 요청’등 의 의도로 판단된 문장에서 요리이름을 특정해 내도록 한다. 띄어쓰기와 단어를 기준으로 라벨링 한, sentence-labels의 형태로 구성된 데이터셋을 이용하여 파인튜닝하여 사용한다.
> - 텍스트생성모델: skt에서 구축한 KoGPT-2모델을 파인튜닝하여 구현하며, 사용자의 입력에 대해 적절한 답변을 할 수 있도록 한다. Q-A의 형태로 구성된 데이터셋을 이용하며 파인튜닝한다.
> 
> **[ 프론트엔드 ]**
> 
> 사용자의 편의성을 고려하여, 웹페이지를 구현한다. 
> 
> 프론트는 크게 로그인 및 회원가입 화면과 메인페이지로 구현되어 있다.
> 
> 로그인화면에서는 회원가입을 할 수있는 화면과 구글 소셜로그인을 하는 방법 두가지로 구현
> 
> 회원가입시 후 메일인증 후 로그인이 가능하므로 메일인증 페이지도 구현
> 
> 비밀번호 찾기 시에는 비밀번호 재설정이 가능하게 구현
> 
> 메인화면에는 사용자의 채팅이 나오는 화면과 메뉴로 레이아웃이 구성
> 
> 메뉴는 현재 대화 목록 ,이전 대화 목록,설정, 로그아웃으로 구성 
> 
> 채팅을 입력하게 되면 사용자의 입력이 출력이 되고, AI의 응답이 하단에 표기된다.
> 
> 서버를 직접 구동하는것이 아닌 aws lambda상에 클라우드로 구현하였기에, 프론트는 aws s3 bucket에 업로드 한 후 aws cloudfront로 연결하여 https주소상으로 연결되게 한다.
> 
> 얻은 https상의 주소를 Gabia에서 구매한 DNS에 연결하여 사용자가 도메인네임을 입력 시 접속되게 연결
> 
> **[ 백엔드 ]**
>  서버리스 구성으로 백엔드를 구성하며, AWS lambda방식을 이용하여 서버리스로 구성한다.
>  구성 과정은 다음과 같다.
> 
> 로그인 확인의 데이터베이스 연결 및 채팅 시 데이터베이스 연결
> 
> → cold start를 개선하기 위해 이 부분은 전역으로 선언하여, 5분이내에 재요청이 들어오는경우 빠르게 실행
> 
> - AWS lambda를 통해 사용자의 DB와 연동하여 정보를 저장한다.
> - 웹페이지와 연결하기 위해서 API gateway를 get method생성해준다.
> - Axios를 이용하여 endpoint를 api gateway로 설정하고, call해준다.
> - axios형식으로 구성한 React와 Api gateway를 통해 lambda와 연결해준다.
> - 사용자와 AI간의 대화를 AWS lambda상으로 연동
> - 대화의 내용을 AWS DynamoDB상에 저장을 한다.
> 
> 회원가입에 대한 사용자의 정보는 데이터베이스상에 저장을 하고, 비밀번호는 암호화하여 저장하므로,비밀번호 찾기 기능은 지원하지않아, 사용자가 비밀번호를 찾는경우 변경하는 기능으로 제공한다.
> 
> 회원가입 후 보안을 위해 사용자가 입력한 메일로 인증을 보내 인증이 되어야만 로그인이 가능
> 
> 소셜로그인기능(구글)을 추가하여 회원가입 없이 사용할 수 oauth api로 사용자의 정보를 등록한다.
> 
> **[ 데이터베이스 ]**
> 
> cognito를 사용한 일반 회원가입 시 사용자의 정보는 cognito상에 저장이 되어지고, 사용자의
> 
> 정보를 저장하는 개별 DB에는 구글로그인, 일반 로그인 시 개인의 sub값 만이 기록된다.
> 
> 첫 로그인 시 user라는 테이블에 사용자의 sub값이 없는경우, 저장 user(sub)값으로 테이블
> 
> 생성 이 테이블에 사용자와 Ai간 채팅이 저장된다.
> 
> **[ 배포 ]**
> 
> - AWS S3 bucket상에 프론트파일을 업로드하여 http주소를 얻는다
> - 위와 같이 얻은 주소는 보안되지 않은 연결이기때문에 구글로그인 구현이 힘들다.
> - CloudFront로 https의 주소를 얻고, 이전 버킷의 주소를 엑세스 불가능하게 변경
> - 위 https의 주소를 가비아에서 구매한 DNS의 주소에 연결하기 위해 CloudFront에서 aws ACM을 통해 SSL인증을 받아
>     
>     가비아에 cname태그로 DNS와 연결하여 배포한다.
>     
> 
> ![image](https://github.com/user-attachments/assets/c74ce223-1a9d-47c5-81c5-2addcbd9a93f)

> 

---

## 5) 소요 기술

> 프론트엔드 : React (JavaScript,Css)
백엔드 : node js,Axios, AWS(Lambda, API Gateway,Cognito,CloudFront,S3 bucket,ACM)
AI : Python, KoGPT-2, KoBERT, KoELECTRA, PyTorch, PyTorch-Lightning, CoLab, Hugging Face, Ngrok, Flask
DB : AWS DynamoDB, MySQL
협업도구 : [GitHub](https://github.com/IDIOcoder/Chat-bot), Notion
> 

---
